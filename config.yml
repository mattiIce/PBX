# =============================================================================
# SECURITY WARNING: This file contains example credentials
# =============================================================================
# NEVER commit real passwords to version control!
# For production use:
# 1. Copy .env.example to .env
# 2. Fill in your real credentials in .env
# 3. Use environment variables instead of hardcoded values
# See .env.example for the complete list of environment variables
# =============================================================================

server:
  sip_host: 0.0.0.0
  sip_port: 5060
  external_ip: 192.168.1.14
  rtp_port_range_start: 10000
  rtp_port_range_end: 20000
  server_name: Aluminum Blanking Phone System
  version: 1.0.0
api:
  host: 0.0.0.0
  port: 8080
  enable_cors: true
database:
  type: sqlite  # Use sqlite by default (change to postgresql for production)
  # PostgreSQL configuration (used when type: postgresql)
  # Environment variables are used with defaults - customize in .env file if needed
  # Defaults: DB_HOST=localhost, DB_PORT=5432, DB_NAME=pbx_system, DB_USER=pbx_user
  # DB_PASSWORD has no default and MUST be set in .env file for PostgreSQL
  host: ${DB_HOST}  # Database host (default: localhost)
  port: ${DB_PORT}  # Database port (default: 5432)
  name: ${DB_NAME}  # Database name (default: pbx_system)
  user: ${DB_USER}  # Database user (default: pbx_user)
  password: ${DB_PASSWORD}  # Database password (REQUIRED: set in .env file for PostgreSQL)
  # SQLite configuration (used when type: sqlite)
  path: pbx.db  # SQLite database file path
extensions:
- number: '1001'
  name: Codi Mattinson
  password: 'password1001'  # SECURITY: Change to strong password in production
  allow_external: true
  email: 'cmattinson@albl.com'
  voicemail_pin: '1234'  # SECURITY: Change in production
- number: '1002'
  name: Bill Sautter
  password: 'password1002'  # SECURITY: Change to strong password in production
  allow_external: true
  email: 'bsautter@albl.com'
- number: '1003'
  name: Lisa Dingman
  password: 'password1003'  # SECURITY: Change to strong password in production
  allow_external: false
  email: 'ldingman@albl.com'
- number: '1004'
  name: Customer Service
  password: 'password1004'  # SECURITY: Change to strong password in production
  allow_external: true
  email: 'support@albl.com'
dialplan:
  internal_pattern: ^1[0-9]{3}$
  conference_pattern: ^2[0-9]{3}$
  voicemail_pattern: ^\*[0-9]{3}$
  parking_pattern: ^7[0-9]$
  queue_pattern: ^8[0-9]{3}$
  auto_attendant_pattern: ^0$
features:
  call_recording: true
  call_transfer: true
  call_hold: true
  conference: true
  voicemail: true
  call_parking: true
  call_queues: true
  presence: true
  music_on_hold: true
  auto_attendant: true
  max_call_duration: 7200
recording:
  auto_record: false
  storage_path: recordings
  format: wav
voicemail:
  storage_path: voicemail
  max_message_duration: 180
  max_greeting_duration: 30
  allow_custom_greetings: true
  email_notifications: true
  no_answer_timeout: 30
  smtp:
    host: ${SMTP_HOST}  # SMTP server - set in .env file (example: smtp.gmail.com)
    port: ${SMTP_PORT}  # SMTP port (default: 587)
    use_tls: true
    username: ${SMTP_USERNAME}  # SMTP username - set in .env file
    password: ${SMTP_PASSWORD}  # SMTP password - set in .env file
  email:
    from_address: 'Voicemail@albl.com'
    from_name: ABCo Voicemail
    subject_template: New Voicemail from {caller_id} - {timestamp}
    include_attachment: true
    send_immediately: true
  reminders:
    enabled: true
    time: 09:00
    unread_only: true
conference:
  max_participants: 50
  record_conferences: false
queues:
- number: '8001'
  name: Sales Queue
  strategy: round_robin
  max_wait_time: 300
- number: '8002'
  name: Support Queue
  strategy: least_recent
  max_wait_time: 180
parking:
  range_start: 70
  range_end: 79
  timeout: 120
presence:
  auto_away_timeout: 300
  auto_offline_timeout: 1800
music_on_hold:
  directory: moh
  default_class: default
auto_attendant:
  enabled: true
  extension: '0'
  timeout: 10
  max_retries: 3
  operator_extension: '1001'
  audio_path: 'auto_attendant'
  menu_options:
    - digit: '1'
      destination: '8001'
      description: 'Sales Queue'
    - digit: '2'
      destination: '8002'
      description: 'Support Queue'
    - digit: '3'
      destination: '1003'
      description: 'Accounting'
    - digit: '0'
      destination: '1001'
      description: 'Operator'
logging:
  level: INFO
  file: logs/pbx.log
  console: true
security:
  # Authentication
  require_authentication: true
  
  # FIPS Compliance (REQUIRED FOR PRODUCTION)
  fips_mode: true  # Enable FIPS 140-2 compliant encryption
  enforce_fips: true  # Fail startup if FIPS mode cannot be enabled (requires cryptography library)
  
  # Password Policy
  password:
    min_length: 12  # Minimum password length
    max_length: 128  # Maximum password length
    require_uppercase: true  # Require at least one uppercase letter
    require_lowercase: true  # Require at least one lowercase letter
    require_digit: true  # Require at least one digit
    require_special: true  # Require at least one special character
  
  # Rate Limiting & Brute Force Protection
  rate_limit:
    max_attempts: 5  # Maximum failed login attempts
    window_seconds: 300  # Time window for counting attempts (5 minutes)
    lockout_duration: 900  # Account lockout duration (15 minutes)
  
  # Security Audit Logging
  audit:
    enabled: true  # Enable security audit logging
    log_to_database: true  # Store audit logs in database
    log_to_file: false  # Also log to file (optional)
    log_file: 'logs/security_audit.log'
  
  # TLS/SSL Configuration
  enable_tls: false
  tls_cert_file: ''
  tls_key_file: ''
  
  # SRTP (Secure Real-time Transport Protocol)
  enable_srtp: false
  
  # Legacy settings (kept for backward compatibility)
  max_failed_attempts: 5  # Deprecated - use rate_limit.max_attempts
  ban_duration: 300  # Deprecated - use rate_limit.window_seconds
  min_password_length: 12  # Deprecated - use password.min_length
  require_strong_passwords: true  # Deprecated - use password settings
provisioning:
  enabled: true
  url_format: http://{{SERVER_IP}}:{{PORT}}/provision/{mac}.cfg
  custom_templates_dir: 'provisioning_templates'
  devices: []
trunks: null
integrations:
  active_directory:
    enabled: true  # Set to true when ready to use
    server: ldaps://192.168.1.22:636  # Primary DC: albl-pdc1
    # Fallback server: ldaps://192.168.1.23:636  # Secondary DC: albl-sdc1
    base_dn: DC=albl,DC=com
    user_search_base: CN=Users,DC=albl,DC=com
    bind_dn: CN=Administrator,CN=Users,DC=albl,DC=com
    # SECURITY: Password is loaded from environment variable
    # Set AD_BIND_PASSWORD in .env file (see .env.example for template)
    bind_password: ${AD_BIND_PASSWORD}
    use_ssl: true
    auto_provision: true  # Automatically create/update PBX extensions from AD
    deactivate_removed_users: true  # Disable extensions when users are removed from AD
    
    # Group-based permissions: Map AD security groups to PBX permissions
    # When users are synced, their AD group membership determines their PBX permissions
    # Supports both full DN and CN-only formats for flexible matching
    group_permissions:
      # Admin group - full system privileges
      CN=PBX_Admins,OU=Groups,DC=albl,DC=com:
        - admin
        - manage_extensions
        - view_cdr
        - system_config
      
      # Sales team - external calling privileges
      CN=Sales,OU=Groups,DC=albl,DC=com:
        - external_calling
        - international_calling
        - call_transfer
      
      # Support team - call management features
      CN=Support,OU=Groups,DC=albl,DC=com:
        - call_recording
        - call_queues
        - call_monitoring
      
      # Executive group - VIP features
      CN=Executives,OU=Groups,DC=albl,DC=com:
        - vip_status
        - priority_routing
        - executive_conference
  zoom:
    enabled: false
    account_id: ''
    client_id: ''
    client_secret: ''
    phone_enabled: false
    api_base_url: https://api.zoom.us/v2
  outlook:
    enabled: false
    tenant_id: ''
    client_id: ''
    client_secret: ''
    sync_interval: 300
    auto_dnd_in_meetings: true
  teams:
    enabled: false
    tenant_id: ''
    client_id: ''
    client_secret: ''
    sip_domain: ''
    sbc_fqdn: ''
